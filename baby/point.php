<?php
function point($sei1,$sei2,$mei1,$mei2,$sex) {
	$hyouka{"21M"}=100;
	$hyouka{"23M"}=100;
	$hyouka{"29M"}=100;
	$hyouka{"33M"}=100;
	$hyouka{"39M"}=100;
	$hyouka{"3M"}=90;
	$hyouka{"13M"}=90;
	$hyouka{"15M"}=90;
	$hyouka{"24M"}=90;
	$hyouka{"31M"}=90;
	$hyouka{"32M"}=90;
	$hyouka{"41M"}=90;
	$hyouka{"47M"}=90;
	$hyouka{"48M"}=90;
	$hyouka{"52M"}=90;
	$hyouka{"57M"}=90;
	$hyouka{"61M"}=90;
	$hyouka{"67M"}=90;
	$hyouka{"1M"}=80;
	$hyouka{"5M"}=80;
	$hyouka{"6M"}=80;
	$hyouka{"7M"}=80;
	$hyouka{"8M"}=80;
	$hyouka{"11M"}=80;
	$hyouka{"16M"}=80;
	$hyouka{"17M"}=80;
	$hyouka{"18M"}=80;
	$hyouka{"25M"}=80;
	$hyouka{"35M"}=80;
	$hyouka{"37M"}=80;
	$hyouka{"38M"}=80;
	$hyouka{"45M"}=80;
	$hyouka{"63M"}=80;
	$hyouka{"65M"}=80;
	$hyouka{"68M"}=80;
	$hyouka{"71M"}=80;
	$hyouka{"81M"}=80;
	$hyouka{"30M"}=60;
	$hyouka{"40M"}=60;
	$hyouka{"46M"}=60;
	$hyouka{"49M"}=60;
	$hyouka{"51M"}=60;
	$hyouka{"55M"}=60;
	$hyouka{"72M"}=60;
	$hyouka{"75M"}=60;
	$hyouka{"77M"}=60;
	$hyouka{"78M"}=60;
	$hyouka{"2M"}=40;
	$hyouka{"9M"}=40;
	$hyouka{"12M"}=40;
	$hyouka{"19M"}=40;
	$hyouka{"26M"}=40;
	$hyouka{"27M"}=40;
	$hyouka{"36M"}=40;
	$hyouka{"42M"}=40;
	$hyouka{"43M"}=40;
	$hyouka{"44M"}=40;
	$hyouka{"50M"}=40;
	$hyouka{"53M"}=40;
	$hyouka{"54M"}=40;
	$hyouka{"58M"}=40;
	$hyouka{"59M"}=40;
	$hyouka{"62M"}=40;
	$hyouka{"64M"}=40;
	$hyouka{"66M"}=40;
	$hyouka{"70M"}=40;
	$hyouka{"73M"}=40;
	$hyouka{"76M"}=40;
	$hyouka{"79M"}=40;
	$hyouka{"80M"}=40;
	$hyouka{"4M"}=20;
	$hyouka{"10M"}=20;
	$hyouka{"14M"}=20;
	$hyouka{"20M"}=20;
	$hyouka{"22M"}=20;
	$hyouka{"28M"}=20;
	$hyouka{"34M"}=20;
	$hyouka{"56M"}=20;
	$hyouka{"60M"}=20;
	$hyouka{"69M"}=20;
	$hyouka{"74M"}=20;
	$hyouka{"21F"}=50;
	$hyouka{"23F"}=50;
	$hyouka{"29F"}=50;
	$hyouka{"33F"}=50;
	$hyouka{"39F"}=50;
	$hyouka{"3F"}=100;
	$hyouka{"13F"}=100;
	$hyouka{"15F"}=100;
	$hyouka{"24F"}=100;
	$hyouka{"31F"}=100;
	$hyouka{"32F"}=100;
	$hyouka{"41F"}=100;
	$hyouka{"47F"}=100;
	$hyouka{"48F"}=100;
	$hyouka{"52F"}=100;
	$hyouka{"57F"}=100;
	$hyouka{"61F"}=100;
	$hyouka{"67F"}=100;
	$hyouka{"1F"}=80;
	$hyouka{"5F"}=80;
	$hyouka{"6F"}=80;
	$hyouka{"7F"}=80;
	$hyouka{"8F"}=80;
	$hyouka{"11F"}=80;
	$hyouka{"16F"}=80;
	$hyouka{"17F"}=80;
	$hyouka{"18F"}=80;
	$hyouka{"25F"}=80;
	$hyouka{"35F"}=80;
	$hyouka{"37F"}=80;
	$hyouka{"38F"}=80;
	$hyouka{"45F"}=80;
	$hyouka{"63F"}=80;
	$hyouka{"65F"}=80;
	$hyouka{"68F"}=80;
	$hyouka{"71F"}=80;
	$hyouka{"81F"}=80;
	$hyouka{"30F"}=60;
	$hyouka{"40F"}=60;
	$hyouka{"46F"}=60;
	$hyouka{"49F"}=60;
	$hyouka{"51F"}=60;
	$hyouka{"55F"}=60;
	$hyouka{"72F"}=60;
	$hyouka{"75F"}=60;
	$hyouka{"77F"}=60;
	$hyouka{"78F"}=60;
	$hyouka{"2F"}=40;
	$hyouka{"9F"}=40;
	$hyouka{"12F"}=40;
	$hyouka{"19F"}=40;
	$hyouka{"26F"}=40;
	$hyouka{"27F"}=40;
	$hyouka{"36F"}=40;
	$hyouka{"42F"}=40;
	$hyouka{"43F"}=40;
	$hyouka{"44F"}=40;
	$hyouka{"50F"}=40;
	$hyouka{"53F"}=40;
	$hyouka{"54F"}=40;
	$hyouka{"58F"}=40;
	$hyouka{"59F"}=40;
	$hyouka{"62F"}=40;
	$hyouka{"64F"}=40;
	$hyouka{"66F"}=40;
	$hyouka{"70F"}=40;
	$hyouka{"73F"}=40;
	$hyouka{"76F"}=40;
	$hyouka{"79F"}=40;
	$hyouka{"80F"}=40;
	$hyouka{"4F"}=20;
	$hyouka{"10F"}=20;
	$hyouka{"14F"}=20;
	$hyouka{"20F"}=20;
	$hyouka{"22F"}=20;
	$hyouka{"28F"}=20;
	$hyouka{"34F"}=20;
	$hyouka{"56F"}=20;
	$hyouka{"60F"}=20;
	$hyouka{"69F"}=20;
	$hyouka{"74F"}=20;

	$tenkaku = $sei1 + $sei2;
	$chikaku = $mei1 + $mei2;
	$jinkaku = $sei2 + $mei1;
	$gaikaku = $sei1 + $mei2;
	$soukaku = $tenkaku + $chikaku;
	$gogyou[0] = $tenkaku % 10;
	$gogyou[1] = $jinkaku % 10;
	$gogyou[2] = $chikaku % 10;
	for ($i = 0; $i <= 2; $i++) {
		if ($gogyou[$i] == 1 or $gogyou[$i] == 2) {
			$gogyou[$i] = "";
		} else if ($gogyou[$i] == 3 or $gogyou[$i] == 4) {
			$gogyou[$i] = "";
		} else if ($gogyou[$i] == 5 or $gogyou[$i] == 6) {
			$gogyou[$i] = "y";
		} else if ($gogyou[$i] == 7 or $gogyou[$i] == 8) {
			$gogyou[$i] = "";
		} else if ($gogyou[$i] == 7 or $gogyou[$i] == 8) {
			$gogyou[$i] = "";
		}
		$gogyou[$i] = SJIStoEUC($gogyou[$i]);
	}
	$db = pg_connect("dbname=keishinsya host=rdb.mahoroba.ne.jp port=5432 user=keishinsya password=C7tH6v");
	$request = pg_query($db, "select level from  kenkou where ten='" . $gogyou[0] . "' and jin='" . $gogyou[1] . "' and chi ='" . $gogyou[2] . "';");
	$rows = pg_num_rows($request);
	for ($i = 0; $i < $rows; $i++) {
		$kenkou = pg_fetch_row($request, $i);
	}
	$kenkou = EUCtoSJIS($kenkou[0]);
	if (strstr($kenkou,"")) {
		$kenkou = 1;
	} else if (strstr($kenkou, "")) {
		$kenkou = 0.9;
	} else if (strstr($kenkou, "")) {
		$kenkou = 0.7;
	} else if (strstr($kenkou, "~")) {
		$kenkou = 0.5;
	}

	if (strstr($sex, "M")) {
		$ret = ($hyouka{$tenkaku . $sex} + $hyouka{$jinkaku . $sex} + $hyouka{$gaikaku . $sex} + $hyouka{$soukaku . $sex}) / 4 * $kenkou;
	} else {
		$ret = ($hyouka{$tenkaku . $sex} + $hyouka{$jinkaku . $sex} + $hyouka{$gaikaku . $sex}) / 3 * $kenkou;
	}
	return($ret);
}
?>